<!doctype html>
<html lang="sr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ЛОТО — 7 од 39</title>
  <style>
    :root{--bg:#f7f7f7;--card:#fff;--accent:#1976d2;--ok:#2e7d32;--muted:#666}
    body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);margin:0;padding:20px;color:#111}
    main{max-width:820px;margin:0 auto}
    h1{font-size:1.4rem;margin:0 0 10px}
    .card{background:var(--card);padding:16px;border-radius:8px;box-shadow:0 1px 6px rgba(0,0,0,.06);margin-bottom:12px}
    .grid{display:grid;grid-template-columns:repeat(13,1fr);gap:8px}
    .num{padding:10px 6px;border-radius:6px;text-align:center;background:#fff;border:1px solid #e0e0e0;cursor:pointer;user-select:none}
    .num.selected{background:var(--accent);color:#fff;border-color:var(--accent);font-weight:700}
    .num.result{box-shadow:0 0 0 3px rgba(25,118,210,.12)}
    .num.match{background:var(--ok);border-color:var(--ok);color:#fff}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{padding:8px 12px;border-radius:6px;border:0;background:var(--accent);color:#fff;cursor:pointer}
    button.secondary{background:#666}
    .status{color:var(--muted);margin-top:8px}
    .results{display:flex;gap:8px;align-items:center;margin-top:12px}
    .bubble{display:inline-block;padding:12px 10px;border-radius:999px;background:#fff;border:1px solid #eee;min-width:44px;text-align:center;font-weight:700}
    .matches{margin-top:10px;color:var(--muted)}
    @media (max-width:520px){.grid{grid-template-columns:repeat(7,1fr)}}
  </style>
</head>
<body>
  <main>
    <h1>ЛОТО — 7 од 39</h1>

    <section class="card">
      <div>Изаберите 7 бројева (1–39) или кликните <strong>Аутоматски</strong> за случајни избор.</div>
      <div class="grid" id="numbers"></div>
      <div class="controls">
        <button id="autoPick">Аутоматски бројеви</button>
        <button id="clear" class="secondary">Очисти избор</button>
        <button id="draw">LOTTO</button>
      </div>
      <div class="status" id="status">Изабрано: 0 / 7</div>
    </section>

    <section class="card">
      <h2>Резултат извлачења</h2>
      <div class="results" id="resultBox">
        <!-- result bubbles inserted here -->
      </div>
      <div class="matches" id="matchInfo"></div>
    </section>
  </main>

  <script>
    (function(){
      const total = 39, pickCount = 7;
      const numbersEl = document.getElementById('numbers');
      const statusEl = document.getElementById('status');
      const autoBtn = document.getElementById('autoPick');
      const clearBtn = document.getElementById('clear');
      const drawBtn = document.getElementById('draw');
      const resultBox = document.getElementById('resultBox');
      const matchInfo = document.getElementById('matchInfo');

      let selected = [];

      function renderGrid(){
        numbersEl.innerHTML = '';
        for(let i=1;i<=total;i++){
          const el = document.createElement('div');
          el.className='num';
          el.textContent = i;
          el.dataset.value = i;
          el.addEventListener('click', ()=>toggleNumber(i, el));
          numbersEl.appendChild(el);
        }
        updateUI();
      }

      function toggleNumber(n, el){
        const idx = selected.indexOf(n);
        if(idx !== -1){
          selected.splice(idx,1);
          el.classList.remove('selected');
        } else {
          if(selected.length >= pickCount){
            flashStatus('Можете изабрати само 7 бројева.');
            return;
          }
          selected.push(n);
          el.classList.add('selected');
        }
        updateUI();
      }

      function flashStatus(msg){
        const prev = statusEl.textContent;
        statusEl.textContent = msg;
        setTimeout(()=> statusEl.textContent = prev, 2000);
      }

      function updateUI(){
        statusEl.textContent = `Изабрано: ${selected.length} / ${pickCount}`;
      }

      function getRandomSet(count){
        const arr = Array.from({length:total},(_,i)=>i+1);
        for(let i=arr.length-1;i>0;i--){
          const j = Math.floor(Math.random()*(i+1));
          [arr[i],arr[j]]=[arr[j],arr[i]];
        }
        return arr.slice(0,count).sort((a,b)=>a-b);
      }

      autoBtn.addEventListener('click', ()=>{
        selected = getRandomSet(pickCount).slice();
        // apply selection classes
        Array.from(numbersEl.children).forEach(el=>{
          const v = Number(el.dataset.value);
          el.classList.toggle('selected', selected.includes(v));
        });
        updateUI();
      });

      clearBtn.addEventListener('click', ()=>{
        selected = [];
        Array.from(numbersEl.children).forEach(el=>el.classList.remove('selected','match','result'));
        resultBox.innerHTML = '';
        matchInfo.textContent = '';
        updateUI();
      });

      drawBtn.addEventListener('click', ()=>{
        if(selected.length !== pickCount){
          flashStatus('Морате имати тачно 7 изабраних бројева пре извлачења.');
          return;
        }
        const result = getRandomSet(pickCount);
        showResult(result);
      });

      function showResult(result){
        resultBox.innerHTML = '';
        // mark result numbers and matches
        const matches = [];
        Array.from(numbersEl.children).forEach(el=>{
          el.classList.remove('result','match');
          const v = Number(el.dataset.value);
          if(result.includes(v)) el.classList.add('result');
          if(selected.includes(v) && result.includes(v)) el.classList.add('match');
        });

        result.forEach(n=>{
          const b = document.createElement('div');
          b.className = 'bubble';
          b.textContent = n;
          if(selected.includes(n)) b.style.backgroundColor = 'var(--ok)';
          resultBox.appendChild(b);
        });

        const matched = result.filter(x=>selected.includes(x));
        if(matched.length) {
          matchInfo.textContent = `Погодили сте ${matched.length}: ${matched.join(', ')}`;
        } else {
          matchInfo.textContent = 'Нема поклапања.';
        }
      }

      renderGrid();
    })();
  </script>
</body>
</html>
